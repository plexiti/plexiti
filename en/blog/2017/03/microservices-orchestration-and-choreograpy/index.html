<!doctype html>
<html lang='en'>
<head>
  <script src='http://plexiti.com/en/js/lang.js'></script>
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,600italic,700,700italic,300italic' rel='stylesheet' type='text/css'>
  <meta charset='utf-8'>
  
      
      <title>Microservices Orchestration &amp; Choreography</title>
      
  
    <link href='http://plexiti.com/en/blog/index.xml' rel='alternate' type='application/rss+xml' title='plexiti - (De)coding Domain Knowledge blog' />
  
    <link href='http://plexiti.com/en/blog/index.xml' rel='home' type='application/rss+xml' title='plexiti - (De)coding Domain Knowledge blog' />
  
  <meta name='apple-mobile-web-app-capable' content='yes'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <link href='http://plexiti.com/en/animate.css' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='http://plexiti.com/en/js/woothemes-FlexSlider-06b12f8/flexslider.css' type='text/css' media='screen'>
  <link rel='stylesheet' href='http://plexiti.com/en/js/prettyPhoto_3.1.5/prettyPhoto.css' type='text/css' media='screen'>
  <link href='http://plexiti.com/en/style.css' rel='stylesheet' type='text/css'>

  <link rel='stylesheet' href='http://plexiti.com/en/fonts/lato/plexiti-lato.css' media='screen' />
  <link rel='stylesheet' href='http://plexiti.com/en/fonts/font-awesome/css/font-awesome.min.css' media='screen'>
  <script src='//code.jquery.com/jquery-latest.min.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/modernizr.custom.48287.js'></script>
  
  <link rel='shortcut icon' type='image/x-icon' href='http://plexiti.com/en/favicon.ico' />
  <link rel='apple-touch-icon-precomposed' sizes='114x114' href='http://plexiti.com/en/apple-touch-icon-114x114-precomposed.png'>
  <link rel='apple-touch-icon-precomposed' sizes='72x72' href='http://plexiti.com/en/apple-touch-icon-72x72-precomposed.png'>
  <link rel='apple-touch-icon-precomposed' href='http://plexiti.com/en/apple-touch-fa-57x57-precomposed.png'>

  <script type='text/javascript' src='http://plexiti.com/en/js/moment/moment-with-locales.min.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/bpmn-js/bpmn-viewer.min.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/cmmn-js/cmmn-viewer.min.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/dmn-js/dmn-viewer.min.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/plexiti.js'></script>
  <script type='text/javascript' src='http://plexiti.com/en/js/lang.js'></script>

  <link href='http://plexiti.com/en/css/plexiti.css' rel='stylesheet' type='text/css'>
  <link href='http://plexiti.com/en/js/dmn-js/css/dmn-js.css' rel='stylesheet' type='text/css'>
  <link href='http://plexiti.com/en/js/rainbow/rainbow-github.css' rel="stylesheet" type="text/css">

</head>
<body data-spy='scroll' data-target='#TableOfContents' data-offset='50'>
<header>
  <div class='top-bg-color-bar'></div>
  <div class='container'>
    <div class='navbar navbar-default' role='navigation'>
      <div class='navbar-header'>
        <a class='navbar-brand' href='http://plexiti.com/en/'>
          <img src='http://plexiti.com/en/img/logo.png' style='width: 250px; height: 96px' title='plexiti'>
          <span class='logo_subtitle' style='font-size: 12pt;'>(De)coding Domain Knowledge</span>
        </a>
      </div>
      <div class='collapse navbar-collapse'>
        <ul class='nav pull-right navbar-nav'>
          
          
            <li><a href='http://plexiti.com/en/blog/'>Blog</a></li>
          
            <li><a href='http://plexiti.com/en/about/'>About</a></li>
          
        </ul>
      </div>
    </div>
    <div id="social_media_wrapper">
      
        
        
          
          <a href='.' title='This page is available in english.'><i class="fa">en</i></a>
        
      
    </div>
  </div>
</header>

<div class='main' id='post'>
     <section class='hgroup'>
          <div class='container'>
               <h1>Microservices Orchestration &amp; Choreography</h1>
               <h2><span style='float:right'><script>document.write(moment('2017-03-21').locale('en').format('LL'))</script></span></h2>
          </div>
     </section>
     <section>
          <div class='container'>
               <div class='row'>
                    <div id='leftcol' class='col-sm-12 col-md-8' role='main'>
                         <article class='post'>
                              <div class='post_content'>
                                   

<p>In his well known book &ldquo;Building Microservices&rdquo;, Sam Newman wrote: &ldquo;As we start to model more and more complex logic, we have to deal with the problem of <strong>managing business processes that stretch across the boundary of individual services</strong>. [&hellip;] When it comes to actually implementing this flow, there are two styles of architecture we could follow. With <strong>orchestration</strong>, we rely on a central brain to guide and drive the process, much like the conductor in an orchestra. With <strong>choreography</strong>, we inform each part of the system of its job, and let it work out the details, like dancers all finding their way and reacting to others around them in a ballet.&rdquo;</p>

<h1 id="1-the-orchestration-style"><strong>(1) The Orchestration Style</strong></h1>

<p>With the <strong>orchestration</strong> style, we move the rules governing the interaction among different services into a central, coordinating unit. By issuing requests and coordinating the meaning of the replies for further steps, this unit reminds a bit of the way a conductor interacts with an orchestra. :-)</p>

<figure>
    
    
    
    
    
    
    
    <img src='http://plexiti.com/en/./blog/2017/03/img/microservices-orchestration.png' >
</figure>



<p>Let&rsquo;s work out a simple example:</p>

<ol>
<li>A customer <strong>places an order</strong> in a <em>webshop</em>. An <em>order service</em> might coordinate the following <strong>order fulfillment</strong> like a conductor &hellip;</li>
<li>&hellip; and ask the <em>payment service</em> to <strong>collect money</strong>.</li>
<li>When the <strong>money is collected</strong> &hellip;</li>
<li>&hellip; the order service asks the <em>inventory service</em> to <strong>fetch the items</strong>.</li>
<li>When the <strong>items are fetched</strong> &hellip;</li>
<li>&hellip; the order service asks the <em>shipment service</em> to <strong>ship the parcel</strong>.</li>
<li>When the <strong>parcel is shipped</strong> &hellip;</li>
<li>&hellip; the order service informes that the <strong>order is delivered</strong>.</li>
</ol>

<figure>
    
    
    
    
    
    
    
    <img src='http://plexiti.com/en/./blog/2017/03/img/microservices-orchestration-model.png' >
</figure>



<p>All the logic of the overall service spanning flow for the business process of fulfilling the order resides in a central brain acting as the &ldquo;conductor&rdquo;. Note that for this to be &ldquo;orchestration&rdquo; the only thing relevant is the principle of having that central brain for a business process&rsquo; flow logic. Everything else does not matter: whether the conductor calls the services synchronously or asynchronously, whether it even prefers to wait passively until other services decide to pull their tasks, whether the flow logic resides in a sophisticated enterprise service bus (ESB) or rather sits inside another microservice, whether you implement the flow logic by means of a hard coded process manager or a configurable engine. The governing principle for the interaction between the services remains for all these cases the same: <strong>orchestration</strong>.</p>

<h1 id="pros-and-cons-of-orchestration">Pros and Cons of Orchestration</h1>

<p>Of course, a central conductor can easily track the state of the overall process flow and e.g. inform the users about it. As it coordinates everything, it can straightforwardly implement requirements like coordinating several steps in parallel, triggering time based actions or even &ldquo;rolling back&rdquo; whole business processes and coordinating any necessary &ldquo;compensating&rdquo; actions like e.g. paying back money already collected from a customer.</p>

<p>The downside to the orchestration approach is that the conductor can easily become &ldquo;too much&rdquo; of a central authority and central point where most of the logic starts to live. Sam Newman states that in practice he has seen this approach &ldquo;result in a small number of smart god services telling anemic CRUD-based services what to do&rdquo;. But what hurts even more is that the need to change the central unit can become a bottleneck to one of the central selling points of microservices. Microservices should be as autonomous as possible and enable the teams maintaining them to deliver new business features as autonomous and fast as possible.</p>

<h1 id="2-the-choreography-style"><strong>(2) The Choreography Style</strong></h1>

<p>With the <strong>choreography</strong> style, we move the rules governing the interaction among different services into the decentral units, the microservices interacting to reach the goal of a business process. Each part of the system knows the job it is responsible for, and must work out the details on its own.</p>

<figure>
    
    
    
    
    
    
    
    <img src='http://plexiti.com/en/./blog/2017/03/img/microservices-orchestration-and-choreograpy.png' >
</figure>



<p>In our example, when a customer places an order in a web shop, a &ldquo;new order created&rdquo; event might be published and subscribed to by the &ldquo;payment service&rdquo; to get the money collected, an &ldquo;inventory service&rdquo; might react on the fact that the order &ldquo;payment is collected&rdquo; and reserve and fetch the reserved items and the &ldquo;shipment service&rdquo; might finally trigger the moment it learns via another event that all the &ldquo;order items are fetched&rdquo;.</p>

<figure>
    
    
    
    
    
    
    
    <img src='http://plexiti.com/en/./blog/2017/03/img/microservices-choreography-model.png' >
</figure>



<p>The logic of the overall service spanning flow for the business process of fulfilling the order is now distributed across the interacting services. Note that even though the choreography style is very often discussed in terms of an &ldquo;Event Driven Architecture&rdquo; the thing most relevant for me calling this &ldquo;choreography&rdquo; is actually the principle of decentralising &ldquo;the brain&rdquo; for a business process&rsquo; overal flow logic. Having said that, the notion of publishing events and allowing anybody else to subscribe to them of course enables the autonomy of the independent services to decide themselves &ldquo;what to do&rdquo;.</p>

<h1 id="pros-and-cons-of-choreography">Pros and Cons of Choreography</h1>

<p>In general the majority of articles I read so far favor this approach of choreography over the aforementioned orchestration. The approach is regarded to be significantly more &ldquo;decoupled&rdquo;, escpecially in the sense that new features can more often be deployed autonomously. I agree: for example, a brand new &ldquo;NotificationService&rdquo; keeping the customer informed about the status of the fulfillment process based on his own custom mail settings could be developed and deployed without affecting any of the existing services.</p>

<p>As a downside of this approach Sam Newman discusses that the explicit view of the business process is now only implicitely reflected in the configuration data (like event subscriptions) of participating services. Additional monitoring is now needed to ensure that one can track and understand the things that have happened in a particular execution of the business process. Martin Fowler addresses the same issue, when he says in a recent article that &ldquo;the danger is that it&rsquo;s very easy to make nicely decoupled systems with event notification, without realizing that you&rsquo;re losing sight of that larger-scale flow&rdquo;.</p>

                              </div>
                         </article>
                         
                    </div>
                    <div class='col-md-4 hidden-sm hidden-xs'>
                         <div class='bs-docs-sidebar hidden-print affix-top' role='complementary' data-spy='affix' data-offset-top='318' data-offset-bottom='405'>
                              <nav id="TableOfContents">
<ul>
<li><a href="#1-the-orchestration-style"><strong>(1) The Orchestration Style</strong></a></li>
<li><a href="#pros-and-cons-of-orchestration">Pros and Cons of Orchestration</a></li>
<li><a href="#2-the-choreography-style"><strong>(2) The Choreography Style</strong></a></li>
<li><a href="#pros-and-cons-of-choreography">Pros and Cons of Choreography</a></li>
</ul>
</nav>
                         </div>
                    </div>
                    <script type='text/javascript'>
                         if($("#TableOfContents").length === 0) {
                              $('.bs-docs-sidebar').each(function(idx, value) {
                                   $(value).append("<nav id='TableOfContents'><ul></ul></nav>");
                              });
                         }
                         $('#TableOfContents ul').each(function() {
                              this.className = "nav";
                         });
                         
                         var numbers = Math.ceil( 967  /  184 );
                         $('#TableOfContents ul').prepend("<li><a href='#post'><i class='fa fa-hand-o-right' aria-hidden='true'></i> Read this post in about <span class='read-the-discussion en'><b>" + numbers + "<i class='pl'></i></b></span>&nbsp;...</a></li>");
                         
                    </script>
                    <script type='text/javascript'>
                         $('#TableOfContents a').click(function() {
                              var href = $.attr(this, 'href');
                              href = href.replace(/:/g, '\\:');
                              $('html, body').animate({
                                   scrollTop: jQuery(href).offset().top
                              }, 500, function () {
                                   window.location.hash = href;
                              });
                              return false;
                         });
                    </script>
               </div>
          </div>
     </section>
     <footer>
  <section class='twitter_feed_wrapper'>
    <div class='container'>
      <div class='row'>
        <div class='twitter_feed_icon col-sm-1 col-md-1'><a href='https://twitter.com/MartinSchimak/'><i class='fa fa-twitter'></i></a></div>
        <div class='col-sm-11 col-md-11'>
          <blockquote>
            <p>I&rsquo;m into and onto <a href="http://agilemanifesto.org">Agile</a>, <a href="http://dddcommunity.org/learning-ddd/what_is_ddd/">DDD</a>, <a href="http://martinfowler.com/eaaDev/EventNarrative.html">EDA</a>, <a href="https://camunda.org">BPM</a> and <a href="http://www.martinfowler.com/articles/microservices.html">Microservices</a>! When I&rsquo;m not (de-)coding domain knowledge, I&rsquo;m probably organizing <a href="https://meetup.com/microservices-vienna">Microservices Vienna</a> or <a href="https://meetup.com/camunda-vienna">Camunda Vienna</a>. I&rsquo;m co-editor of <a href="http://www.objektspektrum.de">OBJEKTspektrum</a>.</p>
            <cite><a href='https://twitter.com/MartinSchimak/'>@MartinSchimak</a></cite>
          </blockquote>
        </div>
      </div>
    </div>
  </section>
  <section class='copyright'>
    <div class='container'>
        <div class='row'>
            <div class='col-sm-6 col-md-6'></div>
            <div class='text-right col-sm-6 col-md-6'> Copyright &copy; <script>document.write(moment().format('YYYY'))</script> <a href='http://plexiti.com/en/about'>plexiti GmbH</a> - All rights reserved.</div>
        </div>
    </div>
</section>

</footer>

</div>
<script>window.jQuery || document.write('<script src=\'http:\/\/plexiti.com\/en\/js\/jquery-1.9.0.min.js\'><\/script>')</script>
<script src='http://plexiti.com/en/twitter-bootstrap/js/bootstrap.min.js' type='text/javascript'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/modernizr.custom.48287.js'></script>
<script src='http://plexiti.com/en/js/woothemes-FlexSlider-06b12f8/jquery.flexslider-min.js'></script>
<script src='http://plexiti.com/en/js/prettyPhoto_3.1.5/jquery.prettyPhoto.js' type='text/javascript' charset='utf-8'></script>
<script src='http://plexiti.com/en/js/isotope/jquery.isotope.min.js' type='text/javascript'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/jquery.ui.totop.js'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/easing.js'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/wow.min.js'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/snap.svg-min.js'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/restart_theme.js'></script>
<script type='text/javascript' src='http://plexiti.com/en/js/collapser.js'></script>
<script id='dsq-count-scr' src='//plexiti.disqus.com/count.js' async></script>

<script>
    setCookie('lang', 'en', 365)
</script>
</body>
</html>

